# 仓库管理系统 - 便捷操作工具使用说明

## 📋 功能概述

这是一个完整的仓库管理系统工具，提供以下功能：

### 🎯 核心功能
1. **创建空白数据库和Excel文档** - 一键初始化系统
2. **添加操作员** - 管理系统操作人员
3. **添加供应商** - 管理供应商信息
4. **添加仓库** - 创建新的仓库
5. **添加库存** - 添加新的库存项目
6. **处理入库** - 执行入库操作并自动更新库存
7. **处理出库** - 执行出库操作并自动更新库存
8. **查看当前状态** - 实时查看系统状态
9. **更新Excel报表** - 生成详细的Excel报表

### 📊 实时Excel报表
- 自动生成包含所有数据的Excel文件
- 每次操作后自动更新报表
- 包含多个工作表：操作员、供应商、仓库、库存、入库记录、出库记录、仓库汇总、供应关系
- 美观的表格样式和格式

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 运行程序
```bash
python warehouse_manager_tool.py
```

### 3. 初始化系统
选择菜单选项 `1` 来创建空白数据库和Excel文档

### 4. 开始使用
按照菜单提示进行各种操作

## 📖 详细操作指南

### 创建空白数据库和Excel文档 (选项1)
- 自动创建SQLite数据库文件 (`warehouse.db`)
- 自动创建Excel报表文件 (`warehouse_report.xlsx`)
- 建立完整的数据库表结构
- 创建格式化的Excel工作表

### 添加操作员 (选项2)
- 输入操作员姓名
- 输入联系方式
- 系统自动更新Excel报表

### 添加供应商 (选项3)
- 输入供应商编号
- 输入供应商名称
- 输入联系人
- 输入联系方式

### 添加仓库 (选项4)
- 输入仓库名称
- 输入操作员姓名（必须是已存在的操作员）
- 输入负责人
- 系统自动记录创建日期

### 添加库存 (选项5)
- 输入库存编号
- 输入仓库名称（必须是已存在的仓库）
- 输入数量
- 输入单价

### 处理入库 (选项6)
- 输入入库编号
- 输入库存编号（必须是已存在的库存）
- 输入货物编号
- 输入数量
- 输入货物名称
- 输入单价
- 输入供应商
- **系统自动更新库存数量**

### 处理出库 (选项7)
- 输入出库编号
- 输入库存编号（必须是已存在的库存）
- 输入货物编号
- 输入数量
- 输入货物名称
- 输入单价
- **系统自动检查库存是否充足并更新库存数量**

### 查看当前状态 (选项8)
- 显示当前库存状态
- 显示仓库汇总信息
- 实时数据展示

### 更新Excel报表 (选项9)
- 手动触发Excel报表更新
- 包含所有最新数据

## 📁 文件说明

### 生成的文件
- `warehouse.db` - SQLite数据库文件
- `warehouse_report.xlsx` - Excel报表文件

### Excel报表工作表
1. **报表信息** - 系统信息和生成时间
2. **操作员** - 所有操作员信息
3. **供应商** - 所有供应商信息
4. **仓库** - 所有仓库信息
5. **库存** - 当前库存状态（包含总价值计算）
6. **入库记录** - 所有入库操作记录
7. **出库记录** - 所有出库操作记录
8. **仓库汇总** - 各仓库的汇总统计
9. **供应关系** - 供应商与仓库的关系

## ⚠️ 注意事项

### 数据完整性
- 添加仓库时必须指定已存在的操作员
- 添加库存时必须指定已存在的仓库
- 入库/出库操作必须指定已存在的库存编号
- 出库时会自动检查库存是否充足

### 文件管理
- 每次选择"创建空白数据库和Excel文档"会删除现有文件
- Excel报表会在每次操作后自动更新
- 建议定期备份数据库文件

### 错误处理
- 系统会显示详细的错误信息
- 操作失败时不会影响现有数据
- 建议按照正确的顺序添加数据（操作员→仓库→库存→入库/出库）

## 🔧 技术特性

### 数据库特性
- 使用SQLite轻量级数据库
- 完整的外键约束
- 自动事务处理
- 数据完整性保护

### Excel报表特性
- 自动格式化表格
- 彩色表头设计
- 自动调整列宽
- 边框和样式美化
- 实时数据更新

### 系统特性
- 交互式菜单界面
- 实时状态显示
- 自动数据验证
- 友好的错误提示

## 📞 技术支持

如果遇到问题，请检查：
1. Python环境是否正确安装
2. 依赖包是否完整安装
3. 文件权限是否正确
4. 数据库文件是否被其他程序占用

## 🎉 使用建议

1. **首次使用**：先选择选项1创建空白系统
2. **数据录入**：按照操作员→供应商→仓库→库存的顺序添加基础数据
3. **日常操作**：主要使用入库和出库功能
4. **状态监控**：定期查看当前状态和Excel报表
5. **数据备份**：定期备份数据库文件

---

**祝您使用愉快！** 🎊 