# 仓库管理系统 - Excel报表功能使用指南

## 功能概述

Excel报表版本的仓库管理系统可以实时生成Excel文件，显示数据库的详细状态，包括：
- 📊 库存状态
- 🏢 仓库汇总
- 👥 操作员信息
- 🏭 供应商信息
- 📥 入库记录
- 📤 出库记录
- 🔗 供应关系

## 文件说明

### 核心文件
- `warehouse_management_excel.py` - Excel报表版本的主程序
- `warehouse_report.xlsx` - 生成的Excel报表文件
- `warehouse.db` - SQLite数据库文件
- `requirements.txt` - 依赖包列表

## 安装和运行

### 1. 安装依赖包
```bash
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pandas openpyxl xlsxwriter
```

### 2. 运行程序
```bash
python warehouse_management_excel.py
```

### 3. 查看结果
程序运行完成后，会生成 `warehouse_report.xlsx` 文件，包含多个工作表。

## Excel报表结构

### 工作表说明

#### 1. **报表信息** (Report Info)
- 生成时间
- 操作类型
- 数据库文件路径
- 系统版本信息

#### 2. **操作员** (Operators)
| 字段 | 说明 |
|------|------|
| 姓名 | 操作员姓名（主键） |
| 联系方式 | 操作员联系电话 |

#### 3. **供应商** (Suppliers)
| 字段 | 说明 |
|------|------|
| 供应商编号 | 唯一标识符（主键） |
| 供应商名称 | 公司或组织名称 |
| 联系人 | 负责人姓名 |
| 联系方式 | 联系电话或邮箱 |

#### 4. **仓库** (Warehouses)
| 字段 | 说明 |
|------|------|
| 仓库名称 | 仓库标识（主键） |
| 操作员 | 负责的操作员 |
| 负责人 | 仓库负责人 |
| 创建日期 | 仓库创建时间 |

#### 5. **库存** (Inventory)
| 字段 | 说明 |
|------|------|
| 库存编号 | 唯一标识符（主键） |
| 仓库名称 | 存放仓库 |
| 数量 | 当前库存数量 |
| 单价 | 货物单价 |
| 负责人 | 仓库负责人 |
| 总价值 | 数量 × 单价 |

#### 6. **入库记录** (Inbound Records)
| 字段 | 说明 |
|------|------|
| 入库编号 | 唯一标识符（主键） |
| 货物编号 | 货物标识 |
| 货物名称 | 货物描述 |
| 数量 | 入库数量 |
| 单价 | 入库单价 |
| 入库日期 | 入库时间 |
| 供应商 | 货物供应商 |
| 入库金额 | 数量 × 单价 |

#### 7. **出库记录** (Outbound Records)
| 字段 | 说明 |
|------|------|
| 出库编号 | 唯一标识符（主键） |
| 货物编号 | 货物标识 |
| 货物名称 | 货物描述 |
| 数量 | 出库数量 |
| 单价 | 出库单价 |
| 出库日期 | 出库时间 |
| 出库金额 | 数量 × 单价 |

#### 8. **仓库汇总** (Warehouse Summary)
| 字段 | 说明 |
|------|------|
| 仓库名称 | 仓库标识 |
| 负责人 | 仓库负责人 |
| 操作员 | 负责的操作员 |
| 库存种类 | 不同货物种类数量 |
| 总数量 | 所有货物总数量 |
| 总价值 | 所有货物总价值 |

#### 9. **供应关系** (Supply Relations)
| 字段 | 说明 |
|------|------|
| 供应商编号 | 供应商标识 |
| 供应商名称 | 供应商名称 |
| 仓库名称 | 供应目标仓库 |
| 联系人 | 供应商联系人 |
| 联系方式 | 联系方式 |

## 功能特点

### 1. **实时更新**
- 每次操作后自动生成新的Excel报表
- 反映最新的数据库状态
- 包含操作类型和时间戳

### 2. **格式美观**
- 表头使用蓝色背景和白色字体
- 自动调整列宽
- 添加边框和网格线
- 数据居中对齐

### 3. **数据完整**
- 包含所有相关表的数据
- 计算派生字段（如总价值）
- 关联查询显示完整信息

### 4. **易于使用**
- 一键生成报表
- 自动保存到指定位置
- 显示文件大小信息

## 使用示例

### 基本操作流程

1. **系统初始化**
   ```python
   wms = WarehouseManagementSystemExcel()
   wms.connect_database()
   wms.create_tables()
   wms.insert_sample_data()
   wms.generate_excel_report("系统初始化")
   ```

2. **添加操作员**
   ```python
   wms.add_operator("新操作员", "13800138004")
   # 自动生成Excel报表
   ```

3. **添加仓库**
   ```python
   wms.add_warehouse("新仓库", "新操作员", "新负责人")
   # 自动生成Excel报表
   ```

4. **处理入库**
   ```python
   wms.process_inbound(
       inbound_code="IN003",
       inventory_code="INV001",
       goods_code="GOODS003",
       quantity=25,
       name="新商品",
       price=100.00,
       supplier="新供应商"
   )
   # 自动生成Excel报表
   ```

5. **处理出库**
   ```python
   wms.process_outbound(
       outbound_code="OUT003",
       inventory_code="INV001",
       goods_code="GOODS001",
       quantity=10,
       name="笔记本电脑",
       price=5000.00
   )
   # 自动生成Excel报表
   ```

### 查看报表

每次操作后，Excel文件会自动更新，您可以：

1. **打开Excel文件**
   - 双击 `warehouse_report.xlsx`
   - 或使用Excel软件打开

2. **查看不同工作表**
   - 点击底部的工作表标签
   - 查看不同类型的数据

3. **数据分析**
   - 使用Excel的筛选功能
   - 创建图表和透视表
   - 导出特定数据

## 高级功能

### 1. **自定义报表**
您可以修改代码来：
- 添加新的工作表
- 自定义列名和格式
- 添加计算公式
- 设置条件格式

### 2. **批量操作**
```python
# 批量添加数据
for i in range(10):
    wms.add_inventory(f"INV{i+5}", "主仓库", 100+i*10, 50.00+i*5)
```

### 3. **数据导出**
```python
# 导出特定数据到CSV
import pandas as pd
data = wms.get_all_data_for_excel()
data['库存'].to_csv('inventory.csv', index=False, encoding='utf-8-sig')
```

## 故障排除

### 常见问题

1. **Excel文件无法打开**
   - 确保文件没有被其他程序占用
   - 检查文件权限
   - 尝试重新生成报表

2. **数据不完整**
   - 检查数据库连接
   - 验证表结构是否正确
   - 确认数据插入成功

3. **格式问题**
   - 确保安装了openpyxl包
   - 检查Excel版本兼容性
   - 尝试使用不同格式保存

### 性能优化

1. **大数据量处理**
   - 分批处理数据
   - 使用数据库索引
   - 优化查询语句

2. **内存使用**
   - 及时关闭数据库连接
   - 清理临时变量
   - 使用生成器处理大量数据

## 扩展建议

### 1. **报表模板**
- 创建自定义Excel模板
- 添加公司logo和样式
- 设置打印格式

### 2. **自动化**
- 定时生成报表
- 邮件发送功能
- 云端存储

### 3. **数据分析**
- 添加统计图表
- 趋势分析功能
- 预警机制

### 4. **多格式支持**
- PDF报表
- HTML报表
- 移动端适配

## 总结

Excel报表功能为仓库管理系统提供了强大的数据可视化和导出能力：

✅ **实时性**: 操作后立即更新报表
✅ **完整性**: 包含所有相关数据
✅ **美观性**: 专业的Excel格式
✅ **易用性**: 一键生成，即开即用
✅ **扩展性**: 支持自定义和扩展

这个功能让您可以轻松地：
- 📊 查看系统状态
- 📈 分析业务数据
- 📋 生成管理报表
- 🔄 跟踪操作历史
- 📤 导出数据给其他系统

通过Excel报表，您可以更好地管理和分析仓库数据，为业务决策提供有力支持！ 